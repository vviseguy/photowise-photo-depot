<script style="display: none;">

    // Code for the outer page
    function redirectToLoginFromEmbedded(embedPageUrl) {
        const loginPage = `https://us-west-2b2hpjjqgl.auth.us-west-2.amazoncognito.com/login/continue`;
        const redirectUrl = encodeURIComponent(`${embedPageUrl}?redirect=${encodeURIComponent(window.location.href)}`);
        window.location.href = `${loginPage}?client_id=59e3vejubvjscpv0vlkkrp1orq&redirect_uri=${redirectUrl}&response_type=code&scope=email+openid+phone`;
    }
    
    window.addEventListener('message', (event) => {
        if (event.data.type === 'redirect_to_login') {
            redirectToLoginFromEmbedded(event.data.embedPageUrl);
            console.log("Redirected for login")
        }
        console.log("Adapter attatched")
    });
    
    function sendAuthCodeToEmbed() {
        const params = new URLSearchParams(window.location.search);
        if (params.has('code')) {
            const authCode = params.get('code');
            const redirectPage = params.get('redirect');
            const embedPageUrl = "https://vviseguy.github.io/photowise-photo-depot/"
            if (redirectPage) {
                const redirectTarget = new URL(redirectPage);
                const embeddedWindow = document.querySelector('iframe');
                embeddedWindow.contentWindow.postMessage({ type: 'auth_code', code: authCode }, redirectTarget.origin);
            }
        }
    }
    
    sendAuthCodeToEmbed();
    </script>